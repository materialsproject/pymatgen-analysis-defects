

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Shockley-Read-Hall Recombination &#8212; pymatgen-analysis-defects</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/nonradiative';</script>
    <link rel="canonical" href="https://materialsproject.github.io/pymatgen-analysis-defects/content/nonradiative.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Photo Conductivity" href="photo-conduct.html" />
    <link rel="prev" title="Finding the location of the point defect" href="defect-finder.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    <p class="title logo__title">pymatgen-analysis-defects</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="defining-defects.html">Defining Defects</a></li>
<li class="toctree-l1"><a class="reference internal" href="defect-finder.html">Finding the location of the point defect</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Shockley-Read-Hall Recombination</a></li>
<li class="toctree-l1"><a class="reference internal" href="photo-conduct.html">Photo Conductivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="formation-energy.html">Formation Energy Diagrams</a></li>

<li class="toctree-l1"><a class="reference internal" href="freysoldt-correction.html">Freysoldt Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api_ref/index.html">Overview of the API.</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_ref/pymatgen.analysis.defects.core.html">pymatgen.analysis.defects.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_ref/pymatgen.analysis.defects.generators.html">pymatgen.analysis.defects.generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_ref/pymatgen.analysis.defects.thermo.html">pymatgen.analysis.defects.thermo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_ref/pymatgen.analysis.defects.ccd.html">pymatgen.analysis.defects.ccd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_ref/pymatgen.analysis.defects.finder.html">pymatgen.analysis.defects.finder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_ref/pymatgen.analysis.defects.recombination.html">pymatgen.analysis.defects.recombination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_ref/pymatgen.analysis.defects.supercells.html">pymatgen.analysis.defects.supercells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_ref/pymatgen.analysis.defects.utils.html">pymatgen.analysis.defects.utils</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/materialsproject/pymatgen-analysis-defects" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/materialsproject/pymatgen-analysis-defects/edit/main/docs/content/nonradiative.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/materialsproject/pymatgen-analysis-defects/issues/new?title=Issue%20on%20page%20%2Fcontent/nonradiative.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/content/nonradiative.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Shockley-Read-Hall Recombination</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-a-single-harmonic-defect">Read a single Harmonic Defect</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-energy-surface">Potential energy surface</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-electron-phonon-matrix-element-with-paws">Evaluating the Electron-Phonon Matrix Element with PAWs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-srh-capture-coefficient">Calculating the SRH Capture Coefficient</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="shockley-read-hall-recombination">
<h1>Shockley-Read-Hall Recombination<a class="headerlink" href="#shockley-read-hall-recombination" title="Permalink to this heading">#</a></h1>
<p>Shockley-Read-Hall (SRH) recombination is the dominant recombination mechanism at lower carrier concentrations.
First-principles calculations of the SRH recombination rate were pioneered in the Van de Walle group at the University of California, Santa Barbara by Prof. Audrius Alisauskas <span id="id1">[<a class="reference internal" href="references.html#id3" title="Audrius Alkauskas, Qimin Yan, and Chris G. Van de Walle. First-principles theory of nonradiative carrier capture via multiphonon emission. Phys. Rev. B, 90(7):075202, August 2014. doi:10.1103/PhysRevB.90.075202.">Alkauskas <em>et al.</em>, 2014</a>]</span>.
Additional development have been made to better integrate the methodology with existing projector-augmented wave methods in <code class="docutils literal notranslate"><span class="pre">VASP</span></code> to enable much faster calculations of the SRH recombination rate. For a more detailed account of the methodology, please see the following reference: <span id="id2">[<a class="reference internal" href="references.html#id2" title="Jimmy-Xuan Shen. Nonradiative Recombination in Semiconductor Alloys. 2018. [Online; accessed 19. Dec. 2022]. URL: https://escholarship.org/uc/item/1c126345.">Shen, 2018</a>]</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># disable warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">pymatgen.analysis.defects.ccd</span> <span class="kn">import</span> <span class="n">HarmonicDefect</span><span class="p">,</span> <span class="n">get_SRH_coefficient</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TEST_FILES</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;../../../tests/test_files/v_Ga/&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="read-a-single-harmonic-defect">
<h2>Read a single Harmonic Defect<a class="headerlink" href="#read-a-single-harmonic-defect" title="Permalink to this heading">#</a></h2>
<p>We can parse an sorted list of directories with <code class="docutils literal notranslate"><span class="pre">HarmonicDefect.from_directories</span></code>.
This will look into each directory for a <code class="docutils literal notranslate"><span class="pre">vasprun.xml</span></code> file from which the structures and energies will be extracted.</p>
<p>The different constructors for <code class="docutils literal notranslate"><span class="pre">HarmonicDefect</span></code> all accept a list of sources where the energies and structures come from.
The relaxed structure will be taken from the <code class="docutils literal notranslate"><span class="pre">relaxed_index</span></code> entry from this list and the electronic structure from this entry will be parsed to help identify the defect band in the band structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dirs01</span> <span class="o">=</span> <span class="p">[</span><span class="n">TEST_FILES</span> <span class="o">/</span> <span class="s2">&quot;ccd_0_-1&quot;</span> <span class="o">/</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">hd0</span> <span class="o">=</span> <span class="n">HarmonicDefect</span><span class="o">.</span><span class="n">from_directories</span><span class="p">(</span>
    <span class="n">directories</span><span class="o">=</span><span class="n">dirs01</span><span class="p">,</span>
    <span class="n">store_bandstructure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The relaxed structure is in dirs01[</span><span class="si">{</span><span class="n">hd0</span><span class="o">.</span><span class="n">relaxed_index</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hd0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The spin channel (</span><span class="si">{</span><span class="n">hd0</span><span class="o">.</span><span class="n">spin</span><span class="si">}</span><span class="s2">) is also automaticalliy determined by the &quot;</span>
    <span class="s2">&quot;IPR, by taking the spin channel who&#39;s defect states have the lowest average IPR across the different k-points.&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The relaxed structure is in dirs01[1]
HarmonicDefect(omega=0.033 eV, charge=0.0, relaxed_index=1, spin=1, defect_band=[(138, 0, 1), (138, 1, 1)])
The spin channel (-1) is also automaticalliy determined by the IPR, by taking the spin channel who&#39;s defect states have the lowest average IPR across the different k-points.
</pre></div>
</div>
</div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">HarmonicDefect.defect_band</span></code> consists of multiple states presented as <code class="docutils literal notranslate"><span class="pre">(iband,</span> <span class="pre">ikpt,</span> <span class="pre">ispin)</span></code> index tuples, if <code class="docutils literal notranslate"><span class="pre">defect_band</span></code> was not provided to the constructor, the <code class="docutils literal notranslate"><span class="pre">relaxed_index</span></code> entry in the directory list will be checked for a Procar file, which will be parsed to give the “best guess” of the defect state in the band structure.
The band index is automatically determined by the inverse participation ratio.
Note that the defect state reports the “most-localized” bands at each k-point so it is possible for the band index of the defect band to change for different kpoint indices <code class="docutils literal notranslate"><span class="pre">ikpt</span></code>.</p>
<div class="alert alert-block alert-info"><b>Note:</b> The automated defect state identification is still in testing you can provide the `defect_band` manually to over-ride the automatic behavior if you notice any issues.
Please report any issues you encounter to the github issue tracker.
</div>
<section id="potential-energy-surface">
<h3>Potential energy surface<a class="headerlink" href="#potential-energy-surface" title="Permalink to this heading">#</a></h3>
<p>The potential energy surface of the defect in a particular charge state is given by:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{2} \omega^2 Q^2\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">hd0</span><span class="o">.</span><span class="n">distortions</span><span class="p">,</span>
    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">hd0</span><span class="o">.</span><span class="n">energies</span><span class="p">)</span> <span class="o">-</span> <span class="n">hd0</span><span class="o">.</span><span class="n">energies</span><span class="p">[</span><span class="n">hd0</span><span class="o">.</span><span class="n">relaxed_index</span><span class="p">])</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;o&quot;</span><span class="p">,</span>
    <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">hd0</span><span class="o">.</span><span class="n">omega</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">xx</span><span class="o">**</span><span class="mi">2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Q [amu$^{1/2}$Å]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy [meV]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/84e74183a9449f1d871d5ee45e3f8f087ddf39aebff875b9a38d3be69039ae47.png" src="../_images/84e74183a9449f1d871d5ee45e3f8f087ddf39aebff875b9a38d3be69039ae47.png" />
</div>
</div>
<p>The band structure of the relaxed structure has a state that can be identified as the defect state using the inverse participation ratio.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bs</span> <span class="o">=</span> <span class="n">hd0</span><span class="o">.</span><span class="n">relaxed_bandstructure</span>
<span class="n">eigs</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">bands</span><span class="p">[</span><span class="n">hd0</span><span class="o">.</span><span class="n">spin</span><span class="p">][:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">eigs_ref_efermi</span> <span class="o">=</span> <span class="n">eigs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">([</span><span class="n">eigs_ref_efermi</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">eigs_ref_efermi</span><span class="p">[</span><span class="n">hd0</span><span class="o">.</span><span class="n">defect_band_index</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">bs</span><span class="o">.</span><span class="n">efermi</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">bs</span><span class="o">.</span><span class="n">efermi</span> <span class="o">+</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Energy Level Spin:</span><span class="si">{</span><span class="n">hd0</span><span class="o">.</span><span class="n">spin</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/19b7821474acd1c0f87b7c38866ae7b302882deb9207f3539d772a6bde01e033.png" src="../_images/19b7821474acd1c0f87b7c38866ae7b302882deb9207f3539d772a6bde01e033.png" />
</div>
</div>
</section>
</section>
<section id="evaluating-the-electron-phonon-matrix-element-with-paws">
<h2>Evaluating the Electron-Phonon Matrix Element with PAWs<a class="headerlink" href="#evaluating-the-electron-phonon-matrix-element-with-paws" title="Permalink to this heading">#</a></h2>
<p>Methods for evaluating electron-phonon interactions in solids from ab initio calculations are well established.
We use the frozen-phonon method, whereby all the atoms in a supercell are displaced according to the eigenmode of the special phonon.
The coupling between of the atomic displacements and the electronic properties of the system is represented by the electron-phonon matrix element (epME).
The epME of the special phonon (parameterized by Q) is given by:</p>
<div class="math notranslate nohighlight">
\[ W_{if} = \left&lt; \psi_i \left| \frac{\partial \hat h}{\partial Q} \right| \psi_f \right&gt; 
= (\varepsilon_i - \varepsilon_f) \frac{\left&lt;\psi_f | \psi_i({\delta Q}) \right&gt;}{\delta Q}\]</div>
<p>Note the the initial and final states here are determined by the process you are studying.
If you are looking at defect capture, the initial state will be the band edge state and the final state will be the defect state.
The overlap above is for the all-electron wavefunction, under the PAW formalism in VASP the overlap in the expression above can be expressed using the psuedo-wavefunctions <span class="math notranslate nohighlight">\(\tilde \psi_{i,f}\)</span> and the overlap operator <span class="math notranslate nohighlight">\(\hat S\)</span>:</p>
<div class="math notranslate nohighlight">
\[ W_{if} =  (\varepsilon_i - \varepsilon_f) \frac{\left&lt;\tilde \psi_f |\hat S |\tilde \psi_i({\delta Q}) \right&gt;}{\delta Q}\]</div>
<p>This expression above can be calculated VASP version 6 and above by copying the <code class="docutils literal notranslate"><span class="pre">WAVECAR</span></code> file from the displaced (δQ) structure into the directory that already contains the relaxed calculations directory as <code class="docutils literal notranslate"><span class="pre">WAVECAR.QQQ</span></code> and then running VASP with <code class="docutils literal notranslate"><span class="pre">LWSWQ</span> <span class="pre">=</span> <span class="pre">.TRUE.</span></code>.
This will calculate the overlap part in the expression above and write it into the <code class="docutils literal notranslate"><span class="pre">WSWQ</span></code> file.
Automatic parsing of the <code class="docutils literal notranslate"><span class="pre">WSWQ</span></code> file has been implmented in <code class="docutils literal notranslate"><span class="pre">pymatgen.io.vasp.outputs</span></code>.
The <code class="docutils literal notranslate"><span class="pre">HarmonicDefect.get_elph_me</span></code> method will read a list of <code class="docutils literal notranslate"><span class="pre">WSWQ</span></code> objects and compute the epME via finite difference by calculating the overlap for a series of displacements.</p>
<p>To compute the electron phonon matrix element, we must first populate the <code class="docutils literal notranslate"><span class="pre">wswq</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">HarmonicDefect</span></code> object by reading the <code class="docutils literal notranslate"><span class="pre">WSWQ</span></code> files from a directory where they have been labeled in <code class="docutils literal notranslate"><span class="pre">WSWQ.i</span></code> where the index <code class="docutils literal notranslate"><span class="pre">i</span></code> is used to sort the <code class="docutils literal notranslate"><span class="pre">WSWQ</span></code> files to help compute the epME via finite difference.
As an example, we will use the three <code class="docutils literal notranslate"><span class="pre">WSWQ</span></code> files in the generated by the three displaces in <code class="docutils literal notranslate"><span class="pre">hd0</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wswq_dir</span> <span class="o">=</span> <span class="n">TEST_FILES</span> <span class="o">/</span> <span class="s2">&quot;ccd_0_-1&quot;</span> <span class="o">/</span> <span class="s2">&quot;wswqs&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The parsed WSWQ files are: </span><span class="si">{</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">wswq_dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;WSWQ*&#39;</span><span class="p">)]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">hd0</span><span class="o">.</span><span class="n">read_wswqs</span><span class="p">(</span><span class="n">TEST_FILES</span> <span class="o">/</span> <span class="s2">&quot;ccd_0_-1&quot;</span> <span class="o">/</span> <span class="s2">&quot;wswqs&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parsed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">hd0</span><span class="o">.</span><span class="n">wswqs</span><span class="p">)</span><span class="si">}</span><span class="s2"> WSWQ files.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The parsed WSWQ files are: [&#39;WSWQ.2&#39;, &#39;WSWQ.1&#39;, &#39;WSWQ.0&#39;]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parsed 3 WSWQ files.
</pre></div>
</div>
</div>
</div>
<p>The epME is computed by the <code class="docutils literal notranslate"><span class="pre">HarmonicDefect.get_elph_me</span></code> method, which requires the defect band index.
Since we know the band edge state is at the Gamma point from analyzing the bulk cell and that the second kpoint index is Gamma in our supercell calculations, can pass the <code class="docutils literal notranslate"><span class="pre">ikpt</span> <span class="pre">=</span> <span class="pre">1</span></code> defect electronic state into the <code class="docutils literal notranslate"><span class="pre">get_elph_me</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The automatically determined defect electronic states are: </span><span class="si">{</span><span class="n">hd0</span><span class="o">.</span><span class="n">defect_band</span><span class="si">}</span><span class="s2"> &quot;</span>
    <span class="s2">&quot;(with [band, k-point, spin] indexing).&quot;</span><span class="p">)</span>
<span class="n">epME</span> <span class="o">=</span> <span class="n">hd0</span><span class="o">.</span><span class="n">get_elph_me</span><span class="p">(</span><span class="n">defect_state</span><span class="o">=</span><span class="p">(</span><span class="mi">138</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The resulting array of shape </span><span class="si">{</span><span class="n">epME</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> contains the matrix elements from the &quot;</span>
    <span class="s2">&quot;defect state to all other states at the same k-point.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The automatically determined defect electronic states are: [(138, 0, 1), (138, 1, 1)] (with [band, k-point, spin] indexing).
The resulting array of shape (216,) contains the matrix elements from the defect state to all other states at the same k-point.
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculating-the-srh-capture-coefficient">
<h2>Calculating the SRH Capture Coefficient<a class="headerlink" href="#calculating-the-srh-capture-coefficient" title="Permalink to this heading">#</a></h2>
<p>To calculate the Shockley-Read-Hall (SRH) capture coefficient, we also need the potential energy surface of the final state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dirs10</span> <span class="o">=</span> <span class="p">[</span><span class="n">TEST_FILES</span> <span class="o">/</span> <span class="s2">&quot;ccd_-1_0&quot;</span> <span class="o">/</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">hd1</span> <span class="o">=</span> <span class="n">HarmonicDefect</span><span class="o">.</span><span class="n">from_directories</span><span class="p">(</span>
    <span class="n">directories</span><span class="o">=</span><span class="n">dirs10</span><span class="p">,</span>
    <span class="n">store_bandstructure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>With the initial and final potential energy surfaces, and the <code class="docutils literal notranslate"><span class="pre">WSWQ</span></code> data for the initial state, we can calculate the SRH capture coefficient using the <code class="docutils literal notranslate"><span class="pre">get_SRH_coefficient</span></code> function to compute the capture coefficient as a function of temperature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">srh_c</span> <span class="o">=</span> <span class="n">get_SRH_coefficient</span><span class="p">(</span><span class="n">initial_state</span><span class="o">=</span><span class="n">hd0</span><span class="p">,</span> <span class="n">final_state</span><span class="o">=</span><span class="n">hd1</span><span class="p">,</span> <span class="n">defect_state</span><span class="o">=</span><span class="p">(</span><span class="mi">138</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">T</span><span class="o">=</span><span class="n">T</span><span class="p">,</span> <span class="n">dE</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">srh_c</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature [K]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;SRH coefficient [cm$^{-3}$s$^{-1}$]&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/df86a855a3f29366da609bcda1b114b2c0ab3a0d89d344e4983b62f3ed4eb784.png" src="../_images/df86a855a3f29366da609bcda1b114b2c0ab3a0d89d344e4983b62f3ed4eb784.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="defect-finder.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Finding the location of the point defect</p>
      </div>
    </a>
    <a class="right-next"
       href="photo-conduct.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Photo Conductivity</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#read-a-single-harmonic-defect">Read a single Harmonic Defect</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-energy-surface">Potential energy surface</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#evaluating-the-electron-phonon-matrix-element-with-paws">Evaluating the Electron-Phonon Matrix Element with PAWs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-srh-capture-coefficient">Calculating the SRH Capture Coefficient</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jimmy-Xuan Shen
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>